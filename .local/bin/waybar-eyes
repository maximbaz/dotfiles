#!/bin/sh

marker="${XDG_CACHE_HOME:-$HOME/.cache}/waybar-eyes"
eyes=""

run() {
    while true; do
        printf '{"text": "%s"}\n' "$eyes"
        touch "$marker"
        inotifywait -t 900 -q "$marker"
        [ -f "$marker" ] && eyes="$eyes ÔÅÆ" || eyes=""
    done
}

[ "$1" = "done" ] && rm "$marker" || run
